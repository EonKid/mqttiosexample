<!DOCTYPE html>
<html>
	<head>

	</head>
	<body>

		<h1>MQTT Client</h1>

		<p id="main_text">Connecting to MQTT Broker</p>

		<script type="text/javascript" src="mqttws31.js"></script>
		<script type="text/javascript">

			client = new Paho.MQTT.Client("127.0.0.1", 3000, "W101");
			client.onConnectionLost = onConnectionLost;
			client.onMessageArrived = onMessageArrived;

			client.connect({onSuccess:onConnect});

			function onConnect() {
  				write("Connected to 127.0.0.1:3000!");
  				client.subscribe("D101/status");
			}
			function onConnectionLost(responseObject) {
  				if (responseObject.errorCode !== 0) {
  					write("Connection Lost " + responseObject.errorMessage);
  				}
			}
			function onMessageArrived(message) {
				write("Message Arrived: '" + message.payloadString + "'");
			}
			function write(text) {
				document.getElementById("main_text").innerHTML = text; 
			}

		</script>
	</body>
</html>